Сценарий: «Автоматическое создание дерева сертификатов с использованием стандартных расширений»

Целью работы является создание скрипта (.bat), который при запуске полностю автоматически создаёт дерево сертификатов из 3-х уровней. При этом:
• Корневой сертификат УЦ (root ca) - для ВШЭ
• Промежуточный ЦС (mca) - для студенческой группы (GroupXXX)
• Конечный (пользовательский, user) для себя (Name Surname)
При отображении в хранилище Windows дерево сертификатов должно отображаться без ошибок.
Закрытый ключ должен быть зашифрован.

Для сертификатов указать в явном виде стандартные расширения X.509 в соответствии с их назначением:
• Ограничения цепочки - basicConstraints
• Область действия ключа
o Подпись цифровых сертификатов (ca, mca)
o ЭП (если Фамилия студента заканчивается на «а») ИЛИ Шифрование (если Фамилия студента не заканчивается на «а»)
• Расширенная область действия ключа (исходя из Области действия)
• Конечный и промежуточный сертификаты: по 3 разных (всего 6) дополнительных расширения (выбрать самостоятельно исходя из планируемого назначения сертификатов).
